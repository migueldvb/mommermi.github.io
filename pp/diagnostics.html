

<!doctype html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Diagnostics &mdash; Photometry Pipeline 0.9 documentation</title>
    
    <link rel="stylesheet" href="_static/bizstyle.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.9',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/bizstyle.js"></script>
    <link rel="top" title="Photometry Pipeline 0.9 documentation" href="index.html" />
    <link rel="next" title="Problems?" href="problems.html" />
    <link rel="prev" title="Functions" href="functions.html" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <!--[if lt IE 9]>
    <script type="text/javascript" src="_static/css3-mediaqueries.js"></script>
    <![endif]-->
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="problems.html" title="Problems?"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="functions.html" title="Functions"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Photometry Pipeline 0.9 documentation</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Diagnostics</a><ul>
<li><a class="reference internal" href="#overview">Overview</a><ul>
<li><a class="reference internal" href="#html-output">HTML Output</a></li>
<li><a class="reference internal" href="#log-file">LOG File</a></li>
</ul>
</li>
<li><a class="reference internal" href="#diagnostics-details">Diagnostics Details</a><ul>
<li><a class="reference internal" href="#data-overview">Data Overview</a></li>
<li><a class="reference internal" href="#registration">Registration</a></li>
<li><a class="reference internal" href="#photometric-calibration-aperture-size">Photometric Calibration - Aperture Size</a></li>
<li><a class="reference internal" href="#photometric-calibration-catalog-match">Photometric Calibration - Catalog Match</a></li>
<li><a class="reference internal" href="#photometry-results">Photometry Results</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="functions.html"
                        title="previous chapter">Functions</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="problems.html"
                        title="next chapter">Problems?</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/diagnostics.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="diagnostics">
<span id="id1"></span><h1>Diagnostics<a class="headerlink" href="#diagnostics" title="Permalink to this headline">¶</a></h1>
<p>By default, PP creates extensive diagnostic output to provide the user
with a comfortable way to verify the quality of the derived
results. Focusing on human readability, the diagnostic output is in
the form of a HTML website that is accessible with any web browser.</p>
<div class="section" id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<div class="section" id="html-output">
<h3>HTML Output<a class="headerlink" href="#html-output" title="Permalink to this headline">¶</a></h3>
<p>The diagnostic output for one specific data set can be accessed by
opening the <code class="docutils literal"><span class="pre">diagnostics.html</span></code> website that is created in the
respective data directory, e.g., using:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>firefox diagnostics.html
</pre></div>
</div>
<p>Data presented in this website are all stored in a sub-directory named
<code class="docutils literal"><span class="pre">.diagnostics/</span></code> in the respective data directory (note that the dot
prefix makes this a hidden directory).</p>
<p>In case PP has been run using the <cite>all</cite> option on a number of
underlying data directories, it will create <code class="docutils literal"><span class="pre">diagnostics.html</span></code> and
<code class="docutils literal"><span class="pre">.diagnostics/</span></code> in every sub-directory containing data. In order to
provide easy access to the individual <code class="docutils literal"><span class="pre">diagnostics.html</span></code> file, PP
will also create a website named <code class="docutils literal"><span class="pre">summary.html</span></code> in the root
directory from which is has been called, linking to all created
<code class="docutils literal"><span class="pre">diagnostics.html</span></code> websites.</p>
</div>
<div class="section" id="log-file">
<h3>LOG File<a class="headerlink" href="#log-file" title="Permalink to this headline">¶</a></h3>
<p>All tasks performed by PP are documented using Python&#8217;s logging
system. The LOG file is linked from the <code class="docutils literal"><span class="pre">diagnostics.html</span></code> files
(see top of the page). If you run PP using the <cite>all</cite> option, there is
one LOG file for all data sets (unfortunately, I haven&#8217;t figured out
how to change the logging filename during runtime...).</p>
<p>The LOG file can be used to check proper performance of the
pipeline. Its main purpose is to simplify debbuging in case something
went wrong.</p>
</div>
</div>
<div class="section" id="diagnostics-details">
<h2>Diagnostics Details<a class="headerlink" href="#diagnostics-details" title="Permalink to this headline">¶</a></h2>
<p>The following sections discuss the output of a successful pipeline run
in detail based on <a class="reference external" href="http://phy54.phy.nau.edu/photometrypipeline/example_7813/diagnostics.html">this</a> example page.</p>
<div class="section" id="data-overview">
<h3>Data Overview<a class="headerlink" href="#data-overview" title="Permalink to this headline">¶</a></h3>
<p>The top of the diagnostics website lists the data directory, some
general information like the telescope/instrument combination, as well
as the total number of frames processed. The process LOG file (see
above) is linked here, too.</p>
<p>All the frames considered in the process are listed in a table,
providing information on the date and time, target, filter, airmass,
exposure time, and field of view. For each frame, a link is provided
that leads to an <a class="reference external" href="http://phy54.phy.nau.edu/photometrypipeline/example_7813/.diagnostics//mscience0300.fits.png">image of that frame</a>.</p>
</div>
<div class="section" id="registration">
<h3>Registration<a class="headerlink" href="#registration" title="Permalink to this headline">¶</a></h3>
<p>The number of successfully registered frames (and the total number of
frames) is listed, as well as the astrometric catalog that was used in
the registration. Additional information on each frame is given on a
separate website that is linked from here.</p>
<p>The table on the <a class="reference external" href="http://phy54.phy.nau.edu/photometrypipeline/example_7813/.diagnostics/registration.html">registration website</a> lists for each frame some
diagnostics from SCAMP, as well as an image with overplotted stars
from the respective astrometric catalog that was used. The image
enables a quick check of the reliability of the astrometric
solution. Furthermore, the quantifiers <code class="docutils literal"><span class="pre">AS_CONTRAST</span></code> and
<code class="docutils literal"><span class="pre">XY_CONTRAST</span></code> indicate the goodness of the frame&#8217;s rotation angle
and scale, and the frame&#8217;s shift, respectively. <code class="docutils literal"><span class="pre">RA_sig</span></code> and
<code class="docutils literal"><span class="pre">DEC_sig</span></code> provide a sense for positional uncertainties in arcsecs;
<code class="docutils literal"><span class="pre">Chi2_Reference</span></code> and <code class="docutils literal"><span class="pre">Chi2_Internal</span></code> quantify the goodness of
fit. For additional information on these parameters, please refer to
the <a class="reference external" href="http://astromatic.iap.fr/wordpress/wp-content/uploads/2009/01/pdf-dist.png">SCAMP manual</a>.</p>
</div>
<div class="section" id="photometric-calibration-aperture-size">
<h3>Photometric Calibration - Aperture Size<a class="headerlink" href="#photometric-calibration-aperture-size" title="Permalink to this headline">¶</a></h3>
<p>The optimum aperture size used by PP is determined using a
curve-of-growth analysis.</p>
<div class="align-center figure">
<a class="reference internal image-reference" href="_images/aperture_size.png"><img alt="aperture size diagnostics" src="_images/aperture_size.png" style="width: 800px; height: 347px;" /></a>
</div>
<p>The <strong>left plot</strong> documents the curve-of-growth analysis. For a range
of aperture sizes, the flux and SNR of both the target (red line) and
the average over all background sources (black line) are
determined. Note that both the flux and the SNR are fractional
values - they are relative to the maximum flux (of either the target
or the background stars) or the maximum SNR. In order to obtain
reliable photometry, you want to include as much flux as possible but
at the same time keep the aperture as small as possible, in order to
minimize noise introduced by the background - this is reflected by the
SNR&#8217;s peak (see, e.g, Howell&#8217;s <em>Handbook of CCD Astronomy</em> for a
discussion). PP deliberately does not use the aperture radius that
provides the highest SNR. The optimum aperture radius is required to
include at least 70% of the both the target&#8217;s and background sources&#8217;
flux - at the same time, the fractional flux difference between the
target and background sources has to be smaller than 5%. Both
conditions minimize the effect of potential trailing on the photometry
results. The optimum aperture radius is chosen as the smallest
aperture radius that meets the conditions listed above.</p>
<p>The <strong>right plot</strong> shows the median PSF full-width-half-max (FWHM)
based on all sources in the field as a function of time. The red line
indicates the optimum aperture diameter for comparison. The measured
FWHMs should be below the red line, meaning that the aperture diameter
is slightly larger than the image FWHM.  Variations in the FWHM can be
caused by seeing variations and or focus shifts. Note that in the case
of badly focused images, the measured FWHM is a bad indicator of the
real FWHM.</p>
</div>
<div class="section" id="photometric-calibration-catalog-match">
<h3>Photometric Calibration - Catalog Match<a class="headerlink" href="#photometric-calibration-catalog-match" title="Permalink to this headline">¶</a></h3>
<p>PP provides an automated photometric calibration based on a number of
different star catalogs. The calibration process is summarized on the
diagnostics website with a plot of the magnitude zeropoint as a
function of time:</p>
<div class="align-center figure">
<a class="reference internal image-reference" href="_images/phot_calibration.png"><img alt="photometric calibration" src="_images/phot_calibration.png" style="width: 600px; height: 355px;" /></a>
</div>
<p>Variations in the magnitude zeropoint are due to changes in the
airmass, as well as due to transparency and seeing variations (see
FWHM plot above). In the case of the data shown here, thin cirrus led
to the clearly visible transparency variations.</p>
<p>In addition to the overview plot, PP provides <a class="reference external" href="http://phy54.phy.nau.edu/photometrypipeline/example_7813/.diagnostics/calibration.html">detailed information</a>
on every single frame as shown below:</p>
<div class="align-center figure">
<a class="reference internal image-reference" href="_images/phot_calibration_single.png"><img alt="photometric calibration single frame" src="_images/phot_calibration_single.png" style="width: 800px; height: 298px;" /></a>
</div>
<p>The top panel in the <strong>left plot</strong> shows the magnitude zeropoint (red
line) as a function of the number of background catalog stars used in
the calibration.  The number of background stars is reduced by
rejecting the most significant outlier at a time. The blue line
shows the reduced Chi2 of the remaining data points. Currently, 50% of
all background stars are rejected (vertical line) based on their
weighted residuals; weights account for photometric uncertainties and
catalog uncertainties. This representation shows that the magnitude
zeropoint does not depend on the number of background stars used in
the calibration. The bottom panel of this plot shows the magnitude
residuals of the background stars as a function of their brightness;
only those stars used in the final calibration are shown. The
rejection of 50% of all background stars is purely empirical and
usually leads to robust results.</p>
<p>The <strong>right plot</strong> shows the actual image overplotted with those stars
that were used in the final calibration. This map allows to verify
that calibration stars are evenly scattered across the whole field of
view.</p>
<p>Finally, all background stars used in the final calibration of each
frame are listed in a <strong>table</strong>, providing additional information.</p>
</div>
<div class="section" id="photometry-results">
<h3>Photometry Results<a class="headerlink" href="#photometry-results" title="Permalink to this headline">¶</a></h3>
<div class="align-center figure">
<a class="reference internal image-reference" href="_images/phot_results.png"><img alt="photometry results" src="_images/phot_results.png" style="width: 700px; height: 384px;" /></a>
</div>
<p>PP provides final photometry for the actual target(s) in the field, as
well as for one reasonably bright star that acts as a <strong>comparison
star</strong>. The comparison star photometry is derived using the exact same
calibrations and routines as the target, providing a good verification
of the whole process. Usually, the comparison star should have a flat
lightcurve that does not show significant variations. However, it
cannot be ruled out that the comparison star shows intrinsic
variability, or is subject to detector effects, leading to photometric
variability. The comparison star is required to be present in the
first and the last image of the sequence of images provided.</p>
<p>For each target, PP
provides a GIF animation and a lightcurve showing calibrated
photometry. The individual frames in the GIF show the expected target
position (green cross) and the actual aperture placement and size used
(red circle). The GIF allows for identifying target mismatches and
contaminations of the photometry aperture. A <a class="reference external" href="http://phy54.phy.nau.edu/photometrypipeline/example_7813/.diagnostics/7813_results.html">dedicated photometry page</a>
is featured for each target, allowing for a quick and easy
identification of corrupted frames.</p>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="problems.html" title="Problems?"
             >next</a> |</li>
        <li class="right" >
          <a href="functions.html" title="Functions"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Photometry Pipeline 0.9 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2016, Michael Mommert.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.5.
    </div>
  </body>
</html>